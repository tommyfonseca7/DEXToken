<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Decentralized Finance</title>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
    <link rel="stylesheet" href="./static/style/style.css" />
  </head>
  <body>
    <div id="top-bar" style="display: none">
      <div id="title">
        Decentralized Finance Application - DEX Token, Loans, and NFTs
      </div>
      <div id="wallet-info">
        <img
          src="./static/images/wallet.svg"
          alt="Wallet Icon"
          id="wallet-icon"
          class="white-icon"
        />
        <div id="wallet-details">
          <p>Wallet connected: <span id="wallet-address"></span></p>
          <p id="wallet-balance">
            DEX Balance: <span id="wallet-balance-value"></span>
          </p>
        </div>
      </div>
    </div>

    <div class="container" id="container">
      <h1>Connect to your MetaMask account to proceed:</h1>
      <img
        src="./static/images/MetaMask_Fox.svg"
        alt="MetaMask Fox"
        height="200px"
      />
      <button id="connect-button">Connect</button>
    </div>

    <div id="loan-list" style="display: none"></div>

    <!-- Add a new section for the buttons -->
    <div id="button-section">
      <br />
      <br />

      <!-- DEX SECTION -->
      <div class="dex-container">
        <h2>Buy and Sell DEX Tokens:</h2>
        <h3>Current balance(WEI): <span id="wei-balance-value"></span> WEI</h3>

        <button id="buy-dex-button" onclick="buyDex()">Buy DEX</button>
        <button id="sell-dex-button" onclick="sellDex()">Sell DEX</button>
        <button
          id="get-eth-total-balance-button"
          onclick="getEthTotalBalance()"
        >
          Get Total ETH Balance
        </button>
        <button
          id="set-rate-eth-to-dex-button"
          onclick="setRateEthToDex(prompt('Enter new rate:'))"
        >
          Set Rate ETH to DEX
        </button>

        <button id="get-rate-eth-to-dex-button" onclick="getRateEthToDex()">
          Get Rate ETH to DEX
        </button>
      </div>

      <!-- LOAN SECTION -->
      <div class="loan-container">
        <h2>Loans:</h2>
        <button id="loan-button" onclick="openForm()">Loan</button>
        <button id="return-loan-button" onclick="returnLoan()">
          Return Loan
        </button>
        <button
          id="make-loan-request-by-nft-button"
          onclick="makeLoanRequestByNft()"
        >
          Make Loan Request by NFT
        </button>
        <button
          id="cancel-loan-request-by-nft-button"
          onclick="cancelLoanRequestByNft()"
        >
          Cancel Loan Request by NFT
        </button>
        <button id="loan-by-nft-button" onclick="loanByNft()">
          Loan by NFT
        </button>
        <button id="check-loan-button" onclick="checkLoan()">Check Loan</button>
      </div>

      <!-- NFT SECTION -->
      <div class="nft-container">
        <h2>/TODO NFT PART - need to mint</h2>
      </div>

      <button
        id="listen-to-loan-creation-button"
        onclick="listenToLoanCreation()"
      >
        Listen to Loan Creation
      </button>
    </div>

    <!-- POPUP SECTION -->
    <div id="popup" class="popup">
      <div class="popup-content">
        <span class="close-btn" id="close-popup">&times;</span>
        <h2>ETH Total Balance</h2>
        <p id="eth-total-balance"></p>
      </div>
    </div>

    <div id="popupdex" class="popup">
      <div class="popup-content">
        <span class="close-btn" id="close-popupdex">&times;</span>
        <h2>DEX rate</h2>
        <p id="dexrate"></p>
      </div>
    </div>

    <div class="form-popup" id="loanForm">
        <form class="form-container" id="loanForm">
            <h1>Create Loan</h1>
            <label for="dexAmount">DEX Amount:</label>
            <input type="number" id="dexAmount" name="dexAmount" required><br>

            <label for="duration">Loan Duration:</label><br>
            <input type="radio" id="6h" name="duration" value="6h" required>
            <label for="6h">6 hours</label><br>
            <input type="radio" id="12h" name="duration" value="12h">
            <label for="12h">12 hours</label><br>
            <input type="radio" id="18h" name="duration" value="18h">
            <label for="18h">18 hours</label><br>
            <input type="radio" id="24h" name="duration" value="24h">
            <label for="24h">24 hours</label><br>

            <button type="submit" class="btn">Create Loan</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
        </form>

    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <script type="module" src="./static/scripts/main.js"></script>
  </body>
</html>
